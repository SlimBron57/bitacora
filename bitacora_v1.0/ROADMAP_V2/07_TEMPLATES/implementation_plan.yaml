name: "implementation_plan"
category: "strategic"
version: "1.0.0"
description: "Template para documentar planes de implementaci√≥n detallados de componentes complejos"

# Triggers que activan este template
trigger_patterns:
  - "**/04_IMPLEMENTACION/*_IMPLEMENTATION_PLAN.md"
  - "**/04_IMPLEMENTACION/*_PLAN.md"
  - "implementation plan"
  - "roadmap de implementaci√≥n"
  - "fase de desarrollo"

# Personalidad del template
personality:
  tone: "strategic_and_technical"
  depth: "comprehensive"
  style: "narrative_with_code"
  approach: "top-down"  # Desde visi√≥n hasta detalles

# Estructura obligatoria
structure:
  # Metadatos de auditor√≠a
  audit_header:
    required: true
    format: "yaml"
    fields:
      - archivo
      - version
      - fecha_creacion
      - ultima_actualizacion
      - autor
      - proposito
      - estado
      - relacionado_con
      - implementa  # Qu√© DA-XXX implementa
      - criticidad
      - evolucion  # Historia evolutiva del componente (si aplica)

  # Secciones principales
  sections:
    - name: "vision_statement"
      title: "üåä VISI√ìN Y FILOSOF√çA"
      required: true
      prompt: |
        - T√≠tulo evocativo (ej: "ShuiDao (Ê∞¥ÈÅì) - El Camino del Agua")
        - Quote o filosof√≠a que captura la esencia
        - Contexto del problema (qu√© lo motiv√≥)
        - 2-3 p√°rrafos explicando la visi√≥n general
        
        Estilo: Narrativo pero t√©cnicamente fundamentado
    
    - name: "evolutionary_context"
      title: "üß≠ CONTEXTO EVOLUTIVO"
      required: false
      prompt: |
        Si el componente EVOLUCIONA de una versi√≥n anterior:
        
        ### Fase Anterior (v1): Nombre
        - ‚úÖ Lo que se logr√≥
        - ‚úÖ Fundamento t√©cnico establecido
        - **Logro:** Frase clave
        
        ### Fase Actual (v2): Nombre
        - üéØ Nueva capacidad 1
        - üéØ Nueva capacidad 2
        - **Transformaci√≥n:** De X a Y
        
        Incluir tabla comparativa si es √∫til.
    
    - name: "problem_statement"
      title: "üéØ PROBLEMA Y SOLUCI√ìN"
      required: true
      prompt: |
        ### El Problema
        - Descripci√≥n clara del problema (con ejemplos reales)
        - Por qu√© los enfoques anteriores son insuficientes
        - Impacto si no se resuelve
        
        ### La Soluci√≥n Propuesta
        - Enfoque de alto nivel
        - Principios de dise√±o clave
        - Diferenciadores vs alternativas
        
        ### Ejemplos Antes/Despu√©s
        Casos de uso que muestren el cambio transformacional.
    
    - name: "core_architecture"
      title: "üèóÔ∏è ARQUITECTURA CORE"
      required: true
      prompt: |
        Diagramas ASCII mostrando:
        - Componentes principales y sus relaciones
        - Flujo de datos end-to-end
        - Capas de abstracci√≥n
        
        Explicaci√≥n de cada componente principal (1-2 p√°rrafos c/u).
    
    - name: "components_detailed"
      title: "üì¶ COMPONENTES DETALLADOS"
      required: true
      prompt: |
        Para cada componente core:
        
        ### 1. Nombre del Componente
        **Prop√≥sito:** Qu√© hace
        **Responsabilidades:**
        - Responsabilidad 1
        - Responsabilidad 2
        
        **Estructuras de datos:**
        ```rust
        pub struct ComponentName {
            // Campos con comentarios
        }
        ```
        
        **API Principal:**
        ```rust
        impl ComponentName {
            pub fn method(...) -> Result<...>;
        }
        ```
        
        **Ejemplo de uso:**
        ```rust
        // C√≥digo de ejemplo realista
        ```
        
        Repetir para cada componente (3-8 componentes t√≠picamente).
    
    - name: "integration_points"
      title: "üîó PUNTOS DE INTEGRACI√ìN"
      required: true
      prompt: |
        C√≥mo este componente se integra con el resto del sistema:
        
        - **Con TelescopeDB:** Explicaci√≥n + c√≥digo
        - **Con VoxelDB:** Explicaci√≥n + c√≥digo
        - **Con FBCU:** Explicaci√≥n + c√≥digo
        - **Con Context Token 7D:** Explicaci√≥n + c√≥digo
        
        Diagramas de secuencia si ayudan.
    
    - name: "data_flow"
      title: "üåä FLUJO DE DATOS"
      required: true
      prompt: |
        ### Flujo Principal
        1. Input: De d√≥nde viene
        2. Procesamiento: Qu√© transformaciones
        3. Output: A d√≥nde va
        
        ### Flujos Secundarios
        - Manejo de cach√©
        - Persistencia
        - Eventos/notificaciones
        
        Diagramas ASCII detallados.
    
    - name: "implementation_phases"
      title: "üöÄ FASES DE IMPLEMENTACI√ìN"
      required: true
      prompt: |
        Dividir implementaci√≥n en fases l√≥gicas:
        
        ### Fase 1: Nombre (X horas)
        **Objetivo:** Qu√© se logra
        **Tareas:**
        - [ ] Tarea 1 (subtarea A, B, C)
        - [ ] Tarea 2
        **Entregables:**
        - Componente X funcional
        - Tests Y pasando
        
        ### Fase 2: Nombre (Y horas)
        ...
        
        Repetir para todas las fases (3-9 fases t√≠picamente).
        
        **Total estimado:** X horas (~Y d√≠as)
    
    - name: "success_metrics"
      title: "üìä M√âTRICAS DE √âXITO"
      required: true
      prompt: |
        ### M√©tricas Funcionales
        | M√©trica | Target | C√≥mo Medir |
        |---------|--------|------------|
        | Precisi√≥n detecci√≥n | >90% | Test dataset |
        | Cobertura casos | >85% | Test suite |
        
        ### M√©tricas de Performance
        | Operaci√≥n | Target | Actual | Status |
        |-----------|--------|--------|--------|
        | Latencia p95 | <50ms | TBD | ‚è∏Ô∏è |
        
        ### M√©tricas de Calidad
        - Tests pasando: 100%
        - Cobertura c√≥digo: >80%
        - Documentaci√≥n completa: S√≠
    
    - name: "testing_strategy"
      title: "üß™ ESTRATEGIA DE TESTING"
      required: true
      prompt: |
        ### Unit Tests
        - Qu√© componentes
        - Casos edge
        
        ### Integration Tests
        - Qu√© integraciones
        - Escenarios end-to-end
        
        ### Performance Tests
        - Benchmarks cr√≠ticos
        - Stress testing
        
        ### Validation Scripts
        ```bash
        # Comandos para ejecutar tests
        cargo test --lib [componente]
        cargo test --example test_[componente]
        ```
    
    - name: "dependencies_and_constraints"
      title: "üîó DEPENDENCIAS Y RESTRICCIONES"
      required: true
      prompt: |
        ### Dependencias T√©cnicas
        - Componentes Bit√°cora requeridos
        - Crates externos + versiones
        - Features de Rust necesarias
        
        ### Dependencias de Datos
        - TelescopeDB: Qu√© tablas/esquemas
        - VoxelDB: Qu√© templates
        
        ### Restricciones Arquitect√≥nicas
        - DA-XXX: Explicaci√≥n de c√≥mo se respeta
        - DA-YYY: Explicaci√≥n
        
        ### Decisiones de No-Uso
        - ‚ùå NO usar X porque...
        - ‚ùå NO implementar Y porque...
    
    - name: "extensibility_hooks"
      title: "üîå PUNTOS DE EXTENSIBILIDAD"
      required: false
      prompt: |
        Traits/interfaces para futura extensi√≥n:
        
        ```rust
        pub trait ExtensionPoint {
            // M√©todos que permiten customizaci√≥n
        }
        ```
        
        Casos de uso futuros que esto habilita.
    
    - name: "risks_and_mitigations"
      title: "‚ö†Ô∏è RIESGOS Y MITIGACIONES"
      required: true
      prompt: |
        | Riesgo | Impacto | Probabilidad | Mitigaci√≥n |
        |--------|---------|--------------|------------|
        | Complejidad alta | Alto | Media | Dividir en fases |
        | Dependencia X no lista | Medio | Baja | Mock/stub temporal |
        
        ### Contingencias
        - Plan B si riesgo X se materializa
        - Rollback strategy
    
    - name: "future_enhancements"
      title: "üöÄ MEJORAS FUTURAS"
      required: true
      prompt: |
        ### Post-Beta (v1.1)
        - Mejora 1: Descripci√≥n + Esfuerzo estimado
        - Mejora 2: Descripci√≥n + Esfuerzo estimado
        
        ### v2.0 (Long-term)
        - Feature visionaria 1
        - Feature visionaria 2
        
        ### Research Directions
        - √Åreas de investigaci√≥n abiertas
    
    - name: "references"
      title: "üìö REFERENCIAS"
      required: true
      prompt: |
        ### Documentos ROADMAP_V2
        - 00_VISION/03_decisiones-arquitectonicas.md (DA-XXX, DA-YYY)
        - 02_COMPONENTES/CRITICOS/[componente].md
        - 01_ARQUITECTURA/[doc].md
        
        ### Especificaciones
        - BITA-X: T√≠tulo
        - MTT-DSL: Templates relacionados
        
        ### C√≥digo de Referencia
        - src/[modulo]/
        - examples/test_[componente].rs
        
        ### Reflexiones y An√°lisis
        - ROADMAP_V2/[reflexion].md (si aplica)
    
    - name: "implementation_checklist"
      title: "‚úÖ CHECKLIST DE IMPLEMENTACI√ìN"
      required: true
      prompt: |
        Resumen ejecutivo para CHECKLIST_V2.md:
        
        ### Bloque X.Y - Nombre del Componente
        **Total:** X horas (Y d√≠as) | **Prioridad:** CR√çTICA/ALTA/MEDIA
        
        #### X.Y.1 - Fase 1 (Zhours)
        - [ ] Subtarea 1
        - [ ] Subtarea 2
        - [ ] Subtarea 3
        
        #### X.Y.2 - Fase 2 (Zhours)
        ...
        
        **M√©tricas de √©xito:**
        - M√©trica 1 > X%
        - M√©trica 2 < Yms
        - Tests pasando: 100%

  # Footer est√°ndar
  footer:
    required: true
    format: "markdown"
    content: |
      ---
      **Estado:** [üìã Plan | üöß En implementaci√≥n | ‚úÖ Completado]  
      **Complejidad:** [üü¢ BAJA | üü° MEDIA | üî¥ ALTA | üî• EXTREMA]  
      **Criticidad:** [üî¥ CR√çTICA | üü° ALTA | üü¢ MEDIA]  
      **Tiempo Estimado:** X horas (~Y d√≠as)
      
      ---
      *Generado: {fecha}*  
      *Sistema Bit√°cora v1.0 - MTT-DSL Template: implementation_plan*

# Validaciones autom√°ticas
validations:
  - check: "has_phases_breakdown"
    message: "Plan debe incluir fases de implementaci√≥n con tareas"
  
  - check: "has_rust_code_examples"
    message: "Plan t√©cnico debe incluir ejemplos de c√≥digo Rust"
  
  - check: "has_success_metrics"
    message: "Debe especificar m√©tricas cuantificables de √©xito"
  
  - check: "references_architectural_decisions"
    message: "Debe referenciar DAs relevantes (DA-XXX)"
  
  - check: "has_integration_points"
    message: "Debe documentar integraci√≥n con TelescopeDB/VoxelDB"
  
  - check: "has_time_estimates"
    message: "Cada fase debe tener estimaci√≥n de horas/d√≠as"

# M√©tricas de calidad
quality_metrics:
  min_phases: 3
  min_components: 3
  min_rust_examples: 5
  min_references: 4
  min_success_metrics: 3
  max_document_size_kb: 100

# Instrucciones para LLMs
llm_instructions: |
  Cuando generes un PLAN DE IMPLEMENTACI√ìN usando este template:
  
  1. CONTEXTO PREVIO:
     LEE estos documentos primero:
     - 00_VISION/03_decisiones-arquitectonicas.md (todas las DAs)
     - 02_COMPONENTES/[componente].md (si existe la especificaci√≥n)
     - 01_ARQUITECTURA/*.md (dise√±o del sistema)
     - shuidao_flowpacks_reflection.md (si es un plan evolutivo)
     - GUIA.md SECCI√ìN 1.5 (nomenclatura) y 1.7 (timestamps)
  
  2. EXTRAER CONTEXTO:
     Del nombre del archivo y conversaciones previas:
     - "FLOWPACKS_IMPLEMENTATION_PLAN.md" ‚Üí Componente: FlowPacks
     - Identificar si es evoluci√≥n de versi√≥n anterior
     - Identificar an√°lisis/reflexiones que motivaron el plan
  
  3. VERIFICAR ARQUITECTURA DUAL DATABASE:
     ‚ö†Ô∏è CR√çTICO: Bit√°cora usa SOLO TelescopeDB + VoxelDB
     - ‚ùå NO mencionar PostgreSQL, MongoDB, Redis, MySQL, SQLite
     - ‚úÖ S√ç usar TelescopeDB (memoria biogr√°fica)
     - ‚úÖ S√ç usar VoxelDB (templates/patrones)
     - Validar que todos los ejemplos de c√≥digo respeten esto
  
  4. ESTRUCTURA DEL PLAN:
     a. Audit header completo (versi√≥n, fechas, DAs implementadas)
     b. Visi√≥n filos√≥fica (narrativa + cita/met√°fora si aplica)
     c. Contexto evolutivo (si aplica: Fase anterior ‚Üí Fase actual)
     d. Problema detallado + Soluci√≥n propuesta + Ejemplos antes/despu√©s
     e. Arquitectura core (diagramas ASCII + explicaciones)
     f. Componentes detallados (8-12 componentes con c√≥digo Rust)
     g. Integraci√≥n con sistema (TelescopeDB, VoxelDB, FBCU, CTX7D)
     h. Flujo de datos (diagramas + explicaciones)
     i. Fases de implementaci√≥n (3-9 fases, cada una con tareas + horas)
     j. M√©tricas de √©xito (funcionales + performance + calidad)
     k. Testing strategy (unit + integration + performance)
     l. Dependencias y restricciones (DA-XXX que aplican)
     m. Riesgos y mitigaciones (tabla + contingencias)
     n. Referencias completas (docs + c√≥digo + reflexiones)
     o. Checklist ejecutivo (para CHECKLIST_V2.md)
  
  5. C√ìDIGO RUST:
     - Incluir structs realistas con comentarios
     - Incluir traits para extensibilidad
     - Incluir ejemplos de uso concretos
     - Marcar TODOs donde algo es futuro
     - Mantener consistencia con c√≥digo existente (src/)
  
  6. NOMENCLATURA:
     Seguir GUIA.md SECCI√ìN 1.5:
     - Usar nombres distintivos (TelescopeDB, VoxelDB, FBCU, ShuiDao)
     - NO renombrar componentes existentes
     - Consultar si nombre nuevo no es claro
  
  7. TIMESTAMPS:
     Seguir GUIA.md SECCI√ìN 1.7:
     - Usar ./scripts/timestamp.sh para generar fecha/hora
     - Formato: 2025-11-23 23:25:34
     - Actualizar "√öltima Actualizaci√≥n" en audit header
  
  8. DIAGRAMAS ASCII:
     - Usar caracteres ASCII art para diagramas
     - Mantener ancho <80 caracteres
     - Incluir leyenda si es complejo
  
  9. FASES DE IMPLEMENTACI√ìN:
     - Cada fase: Nombre, Objetivo, Tareas (3-6), Entregables, Horas
     - Total horas debe sumar correctamente
     - Orden l√≥gico (dependencias respetadas)
     - Marcar tareas como [ ] para checklist
  
  10. VALIDACI√ìN FINAL:
      Antes de entregar, verificar:
      - ‚úÖ NO hay menciones a DBs externas (Postgres/Redis/Mongo/etc)
      - ‚úÖ SOLO TelescopeDB + VoxelDB en ejemplos
      - ‚úÖ Al menos 5 bloques de c√≥digo Rust
      - ‚úÖ Referencias a al menos 3 DAs (DA-XXX)
      - ‚úÖ M√©tricas cuantificables (>90%, <50ms, etc)
      - ‚úÖ Estimaciones de tiempo en todas las fases
      - ‚úÖ Timestamp correcto en audit header
      - ‚úÖ Tama√±o <100 KB

# Ejemplos de uso
example_outputs:
  - path: "ROADMAP_V2/04_IMPLEMENTACION/FLOWPACKS_IMPLEMENTATION_PLAN.md"
    description: "Plan de evoluci√≥n FlowPacks ‚Üí ShuiDao"
  
  - path: "ROADMAP_V2/04_IMPLEMENTACION/TELESCOPEDB_IMPLEMENTATION_PLAN.md"
    description: "Plan de implementaci√≥n TelescopeDB desde cero"

# Diferencias vs component_spec.yaml
differences_from_component_spec: |
  component_spec.yaml:
  - M√°s bottom-up (detalles ‚Üí visi√≥n)
  - Enfocado en un solo componente
  - Menos narrativo, m√°s t√©cnico directo
  - ~30 KB m√°ximo
  
  implementation_plan.yaml:
  - M√°s top-down (visi√≥n ‚Üí detalles)
  - Abarca m√∫ltiples componentes relacionados
  - Narrativa filos√≥fica + t√©cnica
  - Incluye fases temporales
  - ~100 KB m√°ximo
  - Incluye contexto evolutivo
  - Incluye riesgos y mejoras futuras

# Estado del template
status: "active"
created: "2025-11-23 23:25:34"
last_updated: "2025-11-23 23:25:34"
usage_count: 1  # FLOWPACKS_IMPLEMENTATION_PLAN.md ya existe
effectiveness_score: null  # Se calcular√° despu√©s de validaci√≥n

# Changelog
changelog:
  - version: "1.0.0"
    date: "2025-11-23 23:25:34"
    changes:
      - "Template inicial creado"
      - "Basado en estructura de FLOWPACKS_IMPLEMENTATION_PLAN.md existente"
      - "Validaci√≥n de arquitectura dual database (TelescopeDB + VoxelDB)"
      - "Secci√≥n de contexto evolutivo para planes que evolucionan componentes"
      - "√ânfasis en narrativa filos√≥fica + precisi√≥n t√©cnica"
