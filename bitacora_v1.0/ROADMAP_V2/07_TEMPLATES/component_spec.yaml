name: "component_spec"
category: "technical"
version: "1.0.0"
description: "Template para documentar especificaciones de componentes cr√≠ticos de Bit√°cora"

# Triggers que activan este template
trigger_patterns:
  - "**/02_COMPONENTES/CRITICOS/*.md"
  - "**/02_COMPONENTES/IMPORTANTES/*.md"
  - "component specification"
  - "module design"
  - "implementar componente"

# Personalidad del template
personality:
  tone: "technical"
  depth: "implementation-ready"
  style: "code-focused"
  approach: "bottom-up"  # Desde detalles hasta visi√≥n general

# Estructura obligatoria
structure:
  # Metadatos de auditor√≠a
  audit_header:
    required: true
    format: "yaml"
    fields:
      - archivo
      - version
      - fecha_creacion
      - autor
      - proposito
      - estado
      - relacionado_con
      - implementa  # Qu√© DA-XXX implementa

  # Secciones principales
  sections:
    - name: "purpose"
      title: "üéØ PROP√ìSITO"
      required: true
      prompt: |
        Explicar en 2-3 p√°rrafos:
        - ¬øQu√© problema resuelve este componente?
        - ¬øPor qu√© es cr√≠tico/importante?
        - ¬øC√≥mo se relaciona con la arquitectura general?
      
    - name: "architectural_context"
      title: "üèóÔ∏è CONTEXTO ARQUITECT√ìNICO"
      required: true
      prompt: |
        Diagrama de ubicaci√≥n del componente en el sistema:
        - ¬øD√≥nde vive en el flujo de datos?
        - ¬øCon qu√© otros componentes interact√∫a?
        - ¬øQu√© depende de √©l?
      
    - name: "core_responsibilities"
      title: "üìã RESPONSABILIDADES CORE"
      required: true
      prompt: |
        Lista numerada de responsabilidades principales (3-7 items):
        - Cada responsabilidad debe ser verificable
        - Separar "must have" vs "nice to have"
      
    - name: "data_structures"
      title: "üóÇÔ∏è ESTRUCTURAS DE DATOS"
      required: true
      prompt: |
        Definir structs/types principales en Rust:
        ```rust
        pub struct ComponentName {
            // Campos con comentarios explicativos
        }
        
        pub enum ComponentState {
            // Estados posibles
        }
        ```
      
    - name: "public_api"
      title: "üîå API P√öBLICA"
      required: true
      prompt: |
        M√©todos p√∫blicos que otros componentes pueden llamar:
        ```rust
        impl ComponentName {
            pub fn new(...) -> Result<Self>;
            pub fn core_method(&self, ...) -> Result<Output>;
        }
        ```
      
    - name: "internal_implementation"
      title: "‚öôÔ∏è IMPLEMENTACI√ìN INTERNA"
      required: false
      prompt: |
        Detalles de algoritmos internos:
        - M√©todos privados clave
        - Optimizaciones importantes
        - Trade-offs de dise√±o
      
    - name: "dependencies"
      title: "üîó DEPENDENCIAS"
      required: true
      prompt: |
        - Componentes de Bit√°cora que usa
        - Crates externos requeridos
        - Versiones m√≠nimas
      
    - name: "performance_targets"
      title: "‚ö° OBJETIVOS DE PERFORMANCE"
      required: true
      prompt: |
        Benchmarks esperados:
        | Operaci√≥n | Target | Actual | Status |
        |-----------|--------|--------|--------|
        | insert()  | <10ms  | TBD    | ‚è∏Ô∏è     |
      
    - name: "testing_strategy"
      title: "üß™ ESTRATEGIA DE TESTING"
      required: true
      prompt: |
        - Unit tests cr√≠ticos
        - Integration tests
        - Property-based tests
        - Golden tests
      
    - name: "error_handling"
      title: "‚ö†Ô∏è MANEJO DE ERRORES"
      required: true
      prompt: |
        Tipos de error espec√≠ficos:
        ```rust
        #[derive(Debug, thiserror::Error)]
        pub enum ComponentError {
            #[error("...")]
            ErrorCase1,
        }
        ```
      
    - name: "references"
      title: "üìö REFERENCIAS"
      required: true
      prompt: |
        - Documentos ROADMAP_V2 relacionados
        - Decisiones arquitect√≥nicas (DA-XXX)
        - Especificaciones (BITA-X)
        - C√≥digo de referencia
      
    - name: "next_steps"
      title: "üöÄ PR√ìXIMOS PASOS"
      required: true
      prompt: |
        - Implementaci√≥n inmediata (esta semana)
        - Mejoras v2.0 (futuro)
        - Prioridad y complejidad

  # Footer est√°ndar
  footer:
    required: true
    format: "markdown"
    content: |
      ---
      **Estado:** [üìã Especificaci√≥n | üöß En desarrollo | ‚úÖ Implementado]  
      **Complejidad:** [üü¢ BAJA | üü° MEDIA | üî¥ ALTA]  
      **Prioridad:** [üî¥ CR√çTICA | üü° ALTA | üü¢ MEDIA]
      
      ---
      *Generado: {fecha}*  
      *Sistema Bit√°cora v1.0 - MTT-DSL Template: component_spec*

# Validaciones autom√°ticas
validations:
  - check: "has_rust_code_blocks"
    message: "Componente t√©cnico debe incluir c√≥digo Rust"
  
  - check: "has_performance_targets"
    message: "Debe especificar objetivos de performance"
  
  - check: "references_architectural_decisions"
    message: "Debe referenciar al menos una DA-XXX"

# M√©tricas de calidad
quality_metrics:
  min_rust_examples: 3
  min_references: 2
  min_sections_completed: 10
  max_document_size_kb: 30

# Instrucciones para LLMs
llm_instructions: |
  Cuando generes un documento usando este template:
  
  1. LEE PRIMERO:
     - 00_VISION/DECISIONES_ARQUITECTONICAS.md (DA-XXX relevantes)
     - 01_ARQUITECTURA/*.md (dise√±o del sistema)
     - B20250915-data-compressor/src/ (c√≥digo de referencia)
  
  2. EXTRAE contexto del nombre del archivo:
     - "TELESCOPEDB.md" ‚Üí Component: TelescopeDB, Category: Databases
     - "FBCU_CORE.md" ‚Üí Component: FBCU, Category: Compression
  
  3. BUSCA c√≥digo existente:
     - grep_search para encontrar structs/impls relacionados
     - Usar como base, NO copiar literalmente
  
  4. GENERA secciones en orden:
     - Audit header primero (metadatos)
     - Purpose (problema ‚Üí soluci√≥n)
     - Architectural context (diagrama ASCII)
     - Core responsibilities (lista verificable)
     - Data structures (Rust structs)
     - Public API (m√©todos p√∫blicos)
     - Dependencies (componentes + crates)
     - Performance targets (tabla benchmarks)
     - Testing strategy (tipos de tests)
     - Error handling (enums de error)
     - References (docs relacionados)
     - Next steps (implementaci√≥n)
     - Footer (estado/complejidad/prioridad)
  
  5. VALIDA:
     - ‚úÖ Al menos 3 bloques de c√≥digo Rust
     - ‚úÖ Referencias a DA-XXX
     - ‚úÖ Objetivos de performance cuantificables
     - ‚úÖ Tama√±o <30 KB
  
  6. AJUSTA si necesario:
     - Si componente es simple, omite "internal_implementation"
     - Si es cr√≠tico, a√±ade m√°s detalle en "testing_strategy"
     - Si tiene muchas dependencias, crea tabla en "dependencies"

# Ejemplo de uso
example_output_path: "ROADMAP_V2/02_COMPONENTES/CRITICOS/VOXELDB.md"

# Estado del template
status: "active"
last_updated: "2025-10-26"
usage_count: 0
effectiveness_score: null  # Se calcula despu√©s de usar
